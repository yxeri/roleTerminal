/*
 Copyright 2018 Carmilla Mina Jankovic
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at
 http://www.apache.org/licenses/LICENSE-2.0
 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
 */

$background-color: rgba(0, 0, 0, 0.98);
$second-background-color: #23001e;
$text-color: white;
$second-text-color: #00ffef;
$second-color: #ff00d7;
$light-color: #4b003c;
$darker-color: #23001e;
$warning-color: #910001;
$greyed-out: #6f6f6f;
$focus-color: #000691;
$new-color: #009100;
$darker-new-color: #005f00;
$header-color: #2e001a;

$p-margin: .4em;
$border-width: 1px;
$status-bar-height: 1.6em;
$map-box-padding: .5em;
$padding: .3em;
$border: $border-width solid $second-color;
$border-second: $border-width solid $light-color;
$menu-min-width: 7em;
$menu-max-width: 11em;
$button-margin: .2em;

html, body, div, span, p, a, img, ul, li, video, textarea, button, input, fieldset {
  margin: 0;
  padding: 0;
  border: 0;
  font: inherit;
  font-size: 100%;
  vertical-align: baseline;
}

button::-moz-focus-inner,
input::-moz-focus-inner {
  padding: 0;
  border: none;
}

html, body {
  height: 100%;
  width: 100%;
  background-color: $background-color;
  color: $text-color;
  font-family: monospace;
  font-size: 1.1em;
  -webkit-overflow-scrolling: touch;
  scrollbar-width: none;
  -webkit-text-size-adjust: 100%;
}


span.clickable {
  text-decoration: underline;
  -webkit-user-select: none;
  -moz-user-select: none;
  user-select: none;
}

h1, h2, h3, h4, h5, h6 {
  margin: 0;
  padding: 0;
}

ul, li {
  list-style: none;
  -webkit-overflow-scrolling: touch;
}

textarea {
  width: 100%;
  border-radius: 0;
}

textarea[readonly], input[readonly] {
  background-color: $greyed-out;
}

button {
  background-color: $darker-color;
  color: $second-text-color;
  box-sizing: border-box;
  border: $border;
  padding: $padding;
}

header {
  background-color: $header-color;
  box-sizing: border-box;
  border-top: $border;
  border-bottom: $border;
  color: $second-text-color;
}

span, p {
  min-height: 1em;
}

img {
  max-width: 100%;
  object-fit: scale-down;
  background-color: black;
}

input[type=radio] {
  display: none;
}

input[type="radio"]:checked + span {
  background-color: $second-color;
}

label {
  display: block;

  span {
    border: $border;
    display: inline-block;
    width: 1em;
    height: 1em;
    vertical-align: middle;
    cursor: pointer;
    margin-right: .3em;
    margin-bottom: $border-width;
  }
}

select {
  min-height: 12em;
}

::-webkit-scrollbar {
  display: none;
}

.msgInfo {
  color: $second-text-color;
}

.clickable:hover {
  background-color: $second-color !important;
}

.cover {
  background-color: rgba(0, 0, 0, .6);
  z-index: 9;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}

.toggle:after {
  content: '+';
  float: right;
}

.expanded:after {
  content: '-';
  float: right;
}

/****************
 * View Wrapper *
 ****************/

.column {
  overflow: hidden;
  height: 100%;
}

.viewWrapper {
  display: flex;
  display: -webkit-flex;
  height: 100%;
  width: 100%;
  flex-flow: row wrap;
  -webkit-flex-flow: row wrap;
}

.one {
  width: 100%;
}

.oneOfTwo {
  width: 50%;
  box-sizing: border-box;
}

.oneOfThree {
  width: 33%;
  box-sizing: border-box;
}

.withMenuBar {
  height: calc(100% - #{$status-bar-height});
  order: 1;
}

/**********
 * Dialog *
 **********/

.dialog {
  max-height: calc(99% - 4em);
  max-width: 40em;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
  scrollbar-width: none;
  background-color: $background-color;
  border: $border;
  position: absolute;
  top: 1em;
  left: 0;
  right: 0;
  margin: 0 auto;
  padding: $padding;
  z-index: 10;
  box-shadow: 2px 0 5px black;
  -webkit-box-shadow: 2px 0 5px black;

  input {
    width: 99%;
    padding: .1em;
    margin-bottom: $p-margin;
  }

  input:last-child {
    margin-bottom: 0;
  }

  textarea {
    height: 5em;
  }

  .upperButtons:empty, .lowerButtons:empty, .upperText:empty, .lowerText:empty, .inContainer:empty, .imagesContainer:empty {
    display: none;
  }

  .lowerButtons, .lowerText, .inContainer, .imagesContainer {
    padding-bottom: $padding;
    padding-top: $padding;
  }

  .upperText {
    padding-bottom: $padding / 2;
    margin-bottom: $padding / 2;
    border-bottom: $border;
    text-transform: uppercase;
  }

  div:last-child {
    padding-bottom: 0;
  }

  .lowerButtons {
    float: right;

    .button {
      margin-left: $padding;
    }

    .button:first-child {
      margin-left: 0;
    }
  }
}

.userDialog, .registerDialog {
  img {
    max-height: 200px;
    margin-left: auto;
    margin-right: auto;
  }
}

.userList {
  li {
    display: flex;
    display: -webkit-flex;
    align-items: center;
  }

  .listItemWithImage {
    width: calc(100% - 40px - .1em);
    overflow: hidden;
    text-overflow: ellipsis;
    word-wrap: normal;
  }
}

/**********
 * Inputs *
 **********/

/*
 * A required input field that has been left empty.
 * The class is most commonly added when the input is blurred.
 */
.emptyInput {
  background-color: $warning-color;
}

/*********
 * Views *
 *********/

.docFileView, .forumView, .walletView, .worldMapView, .teamView, .chatView {
  .oneOfTwo {
    width: 0;
  }

  .oneOfTwo:first-child {
    flex-grow: 1;
    -webkit-flex-grow: 1;
    min-width: $menu-min-width;
    max-width: $menu-max-width;
  }

  .oneOfTwo:last-child {
    flex-grow: 5;
    -webkit-flex-grow: 5;
  }
}

.docFileView {
  .docFileHeader {
    border-bottom: $border-width solid $second-color;
    padding-bottom: $padding;
    margin-bottom: $padding;
    display: flex;
    display: -webkit-flex;
    flex-direction: column;
    -webkit-flex-direction: column;

    span:first-child {
      font-size: 1.5em;
    }
  }

  .oneOfTwo:last-child {
    word-wrap: break-word;

    p {
      padding: $padding $padding;
    }
  }
}

.forumView, .docFileView {
  .column {
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none;
  }
}

.columnList {
  -webkit-overflow-scrolling: touch;
  overflow-y: auto;
  scrollbar-width: none;

  .list {
    margin-bottom: $padding * 2;
  }

  li {
    border-bottom: $border-second;
  }
}

/**************
 * Forum View *
 **************/

.forum {
  .postContainer {
    padding-left: 1em;
  }

  .subContainer {
    padding-left: 1em;
  }
}

/*************
 * Chat View *
 *************/

$msgList-msgLine-side-padding: .2em;

.chatView {
  .msgList {
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none;
    word-wrap: break-word;

    li {
      padding-bottom: .5em;

      .listItemImage {
        border-right: $border-second;
        border-top: $border-second;
        border-bottom: $border-second;
        margin-bottom: .2em;
      }
    }

    .msgInfo {
      border-top: $border-second;
      padding: .1em ($msgList-msgLine-side-padding / 2);
      margin-bottom: $p-margin;
      margin-top: .2em;

      span {
        padding: 0 .2em;
      }

      span:first-child {
        padding-left: 0;
      }

      span:last-child {
        padding-right: 0;
      }
    }

    .msgLine {
      padding: 0 $msgList-msgLine-side-padding;
      margin-bottom: $p-margin;
      clear: both;
    }

    .msgLine:last-child {
      margin-bottom: 0;
    }
  }

  .inputArea {
    margin-top: auto;

    textarea {
      width: calc(100% - (#{$msgList-msgLine-side-padding} * 2) - 3em);
      padding: 0 $msgList-msgLine-side-padding;
      border-top: $border;
      border-bottom: $border;
      display: inline-block;
    }

    .buttonContainer {
      position: relative;

      img {
        max-width: 150px;
        max-height: 100px;
        vertical-align: bottom;
        border: $border;
      }

      button {
        border-bottom: none;
        border-left: none;
      }
    }

    .sendButton {
      width: 3em;
      height: 2.4em;
      display: inline-block;
      vertical-align: top;
    }
  }

  .columnChat {
    overflow-y: auto;
    display: flex;
    display: -webkit-flex;
    flex-direction: column;
    -webkit-flex-direction: column;
  }

  .roomInfo {
    border-top: $border;
    border-bottom: $border;
    color: $second-text-color;
    padding: $padding;
    background-color: $darker-color;
    text-align: center;
  }
}

.userRoomList {
  li:first-child {
    padding-top: $padding;
  }
}

.transactionList {
  li {
    border-bottom: $border-second;
  }
}

.list {
  li {
    padding: $padding;
  }

  header {
    padding: $padding;
  }
}

.list:last-child {
  padding-bottom: 0;
}

/*********
 * Lists *
 *********/

/*
 * Generic list.
 */

.list {
  p {
    text-overflow: ellipsis;
    overflow: hidden;
  }
}

/*
 * A list item that has focus in a list.
 */
.focusListItem {
  background-color: $focus-color;
  text-decoration: underline;
}

/*
 * A marked list item in a list.
 * A list item will be marked when the object that it's connected to is updated.
 */
.markListItem {
  background-color: $darker-new-color;
}

/**
 * A new list item in the list.
 * A list item added to a list will temporarily have the newListItem class.
 * The class is removed after a set amount of time.
 */
.newListItem {
  animation: flash;
  animation-timing-function: ease-in-out;
  animation-iteration-count: 1;
  animation-duration: .4s;
}

.flash {
  animation: flash;
  animation-timing-function: ease-in-out;
  animation-iteration-count: 1;
  animation-duration: .4s;
}

@keyframes flash {
  0% {
    background-color: $new-color;
    color: $new-color;
  }

  100% {
    color: inherit;
    background-color: inherit;
    text-shadow: inherit;
  }
}

/**
 * A list item that will be removed from a list.
 * The class is removed after a set amount of time.
 */
.removeListItem {
  background-color: $warning-color;
  color: $warning-color;
}

/*************
 * World Map *
 *************/

$map-box-left: .2em;
$map-padding-fix: 2em;

.worldMapPage {
  padding-top: $map-padding-fix; // Gmaps fix
  overflow: hidden;
  height: 100%;
  width: 100%;

  a {
    display: none !important;
  }
}

.mapLeftClickBox {
  position: absolute;
  z-index: 3;
  top: $map-box-left;
  left: $map-box-left;
  width: calc(100% - ((#{$map-box-left} * 2) + (#{$map-box-padding} * 2) + (#{$border-width} * 2)));
  max-width: 30em;
  max-height: calc(100% - (#{$map-padding-fix * 1.5} + (#{$map-box-left} * 2) + (#{$map-box-padding} * 2) + (#{$border-width} * 2)));
  padding: $map-box-padding;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
  scrollbar-width: none;
  background-color: $background-color;
  border: $border;

  header {
    border: 0;
    background-color: inherit;
    font-size: 1.1em;
  }

  p {
    margin-bottom: $p-margin;
  }
}

.mapRightClickBox {
  position: absolute;
  z-index: 3;
  background-color: $background-color;
  border: $border;
  padding: .2em;
  max-width: 15em;
}

.fallbackMapRightClickBox {
  position: absolute;
  z-index: 3;
  top: $map-box-left;
  left: $map-box-left;
  max-width: 15em;
  padding: .2em;
  background-color: $background-color;
  border: $border;
}

/********
 * Misc *
 ********/

#main {
  height: 100%;
  width: 100%;

  .viewWrapper {
    > .oneOfTwo {
      border-right: $border;
    }

    > .oneOfTwo:nth-child(2) {
      border-right: 0;
    }

    > .oneOfThree {
      border-right: $border;
    }

    > .oneOfThree:nth-child(3) {
      border-right: $border;
    }
  }
}

.clickable {
  cursor: pointer;
}

.menuBar {
  order: 2;
  width: 100%;
  box-sizing: border-box;
  border-top: $border;
  background-color: $header-color;
  display: flex;
  display: -webkit-flex;
  z-index: 8;
  color: $text-color;
  font-size: 1.1em;
  height: calc(#{$status-bar-height} - .2em);

  > span {
    margin-right: .5em;
  }

  > span:last-child {
    margin-right: 0;
  }

  > div {
    margin-right: .5em;
  }

  .clickable {
    text-decoration: none;
  }

  .topMenuButton {
    font-weight: bold;
    background-color: $text-color;
    color: $darker-color;
    padding-left: .1em;
    padding-right: .1em;
    padding-bottom: .2em;
  }

  .topMenu {
    position: absolute;
    background-color: $second-background-color;
    max-width: 12em;
    z-index: 9;
    border-bottom: $border;
    max-height: calc(100% - 1.5em);
    overflow-y: scroll;
    border: $border;
    bottom: calc(#{$status-bar-height} - .2em);
    box-shadow: 2px 0 5px black;
    -webkit-box-shadow: 2px 0 5px black;
    scrollbar-width: none;

    button {
      width: 100%;
      border-left: 0;
      border-right: 0;
    }

    p {
      background-color: $darker-color;
      color: $second-text-color;
      box-sizing: border-box;
      border-bottom: $border;
      padding: $padding;
    }

    li:last-child {
      p {
        border-bottom: 0;
      }
    }
  }
}

.hideOverflow {
  overflow: hidden;
}

.currentUserList {
  margin-bottom: 0;
  padding-top: 0;

  li {
    padding: 0;
  }
}

.imagePreview {
  max-height: 10em;
  max-width: 10em;
  display: block;
}

.listItemImage {
  border-style: none;
  max-width: 40px;
  max-height: 40px;
  float: left;
  margin-right: .1em;
}

.hide {
  display: none !important;
}

#screenFilter {
  height: 100%;
  width: 100%;
  pointer-events: none;
  position: absolute;
  background-color: rgba(255, 236, 5, 0.08);
  animation: screenFilter 20s linear infinite 5s;
  z-index: 11;
  -webkit-box-shadow: inset 0 0 10px rgba(255, 238, 5, 0.18);
  box-shadow: inset 0 0 10px rgba(255, 238, 5, 0.18);
}

.baseGlitch {
  content: attr(subMsg);
  opacity: 0;
  position: absolute;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  font-size: .9em;
}

.fastGlitch, .normalGlitch, .slowGlitch {
  position: relative;
}

.fastGlitch:before {
  @extend .baseGlitch;
  animation: brightness 10s linear infinite 3s;
}

.normalGlitch:before {
  @extend .baseGlitch;
  animation: brightness 16s linear infinite 4s;
}

.slowGlitch:before {
  @extend .baseGlitch;
  animation: brightness 21s linear infinite 5s;
}

@keyframes screenFilter {
  15% {
    background-color: rgba(255, 236, 5, 0.10);
  }
  40% {
    background-color: rgba(255, 236, 5, 0.03);
  }
  80% {
    background-color: rgba(255, 236, 5, 0.10);
  }
}

@keyframes brightness {
  from {
    opacity: 0;
  }
  0.5% {
    opacity: 0.8;
  }
  0.8% {
    opacity: 0.8;
  }
  1% {
    opacity: 0.8;
  }
  1.4% {
    opacity: 0.8;
  }
  1.7% {
    opacity: 0;
  }
}

@media (orientation: portrait), (orientation: landscape) and (max-width: 768px) {
  #main {
    > .viewWrapper {
      > .oneOfTwo:nth-child(2) {
        display: none;
      }

      > .oneOfThree:nth-child(2) {
        display: none;
      }

      > .oneOfThree:nth-child(3) {
        display: none;
      }

      > .oneOfTwo {
        border-right: none;
      }

      > .oneOfThree {
        border-right: none;
      }
    }
  }

  .viewWrapper {
    width: 100%;
  }

  .oneOfTwo {
    width: 100%;
  }

  .mapLeftClickBox {
    left: 0;
    width: calc(100% - ((#{$map-box-padding} * 2) + (#{$border-width} * 2)));
  }

  .chatView {
    .columnList {
      height: calc(1.8em + #{$border-width});
      width: 100%;
      display: flex;
      display: -webkit-flex;
      overflow: inherit;

      .list {
        flex-grow: 1;
        -webkit-flex-grow: 1;

        header {
          text-align: center;
        }

        ul {
          position: absolute;
          height: calc(100% - 1.8em - #{$border-width} - #{$status-bar-height});
          width: 100%;
          left: 0;
          overflow-y: auto;
          background-color: $background-color;
          z-index: 8;
        }

        .toggle:after {
          content: '';
        }

        .expanded:after {
          content: '';
        }
      }
    }

    .columnChat {
      height: calc(100% - 1.8em - #{$border-width});
      width: 100%;
    }

    .oneOfTwo:first-child {
      max-width: 100%;
    }
  }
}
